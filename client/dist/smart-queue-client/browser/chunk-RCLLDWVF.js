import{a as k}from"./chunk-7DKX7YV7.js";import{a as P}from"./chunk-75PX6TYH.js";import{$a as i,Ab as b,Bb as y,Ia as m,Ma as _,Oa as p,Qa as g,Ra as f,Sa as a,Ta as n,Xa as u,Y as x,ab as l,bb as h,hb as C,ib as v,jb as S,ua as s,va as d}from"./chunk-FUL3TK4O.js";var M=(t,r)=>r._id;function O(t,r){if(t&1&&(a(0,"div",11)(1,"div",12),i(2),n(),a(3,"div",13)(4,"span",5),i(5,"meeting_room"),n(),i(6),n()()),t&2){let e=r.$implicit,o=u(2);_("pulse",o.isRecent(e.calledAt)),s(2),l(e.ticketNumber),s(4),h(" Guichet ",e.counterNumber||"-"," ")}}function w(t,r){if(t&1&&(a(0,"div",6),g(1,O,7,4,"div",10,M),n()),t&2){let e=u();s(),f(e.queueStatus.nowServing)}}function E(t,r){t&1&&(a(0,"div",14)(1,"span",5),i(2,"hourglass_empty"),n(),a(3,"p"),i(4,"Aucun ticket en cours"),n()())}function D(t,r){if(t&1&&(a(0,"div",15)(1,"span",16),i(2),n(),a(3,"span",17),i(4),n()()),t&2){let e=r.$implicit,o=r.$index;s(2),l(o+1),s(2),l(e.ticketNumber)}}function I(t,r){if(t&1&&(a(0,"div",8),g(1,D,5,2,"div",15,M),n()),t&2){let e=u();s(),f(e.queueStatus.nextInQueue.slice(0,8))}}function Q(t,r){t&1&&(a(0,"p",18),i(1,"Aucun ticket en attente"),n())}var F=(()=>{class t{constructor(e,o){this.statsService=e,this.socketService=o,this.queueStatus=null,this.currentTime=new Date,this.subscriptions=[]}ngOnInit(){this.loadQueueStatus(),this.subscriptions.push({unsubscribe:()=>clearInterval(setInterval(()=>this.currentTime=new Date,1e3))}),setInterval(()=>this.currentTime=new Date,1e3),this.subscriptions.push(this.socketService.onTicketCalled().subscribe(()=>this.loadQueueStatus()),this.socketService.onTicketUpdated().subscribe(()=>this.loadQueueStatus()),this.socketService.onTicketCreated().subscribe(()=>this.loadQueueStatus()));let e=setInterval(()=>this.loadQueueStatus(),3e4);this.subscriptions.push({unsubscribe:()=>clearInterval(e)})}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}loadQueueStatus(){this.statsService.getQueueStatus().subscribe({next:e=>{e.success&&e.data&&(this.queueStatus=e.data)}})}isRecent(e){return e?Date.now()-new Date(e).getTime()<3e4:!1}static{this.\u0275fac=function(o){return new(o||t)(d(k),d(P))}}static{this.\u0275cmp=x({type:t,selectors:[["app-queue-display"]],standalone:!0,features:[C],decls:25,vars:6,consts:[[1,"queue-display-page"],[1,"display-header"],[1,"time"],[1,"display-content"],[1,"now-serving"],[1,"material-icons"],[1,"serving-grid"],[1,"waiting-section"],[1,"waiting-list"],[1,"display-footer"],[1,"serving-card",3,"pulse"],[1,"serving-card"],[1,"ticket-number"],[1,"counter-info"],[1,"no-tickets"],[1,"waiting-item"],[1,"position"],[1,"ticket-num"],[1,"no-waiting"]],template:function(o,c){o&1&&(a(0,"div",0)(1,"header",1)(2,"h1"),i(3,"\u{1F3AB} Smart Queue"),n(),a(4,"div",2),i(5),v(6,"date"),n()(),a(7,"main",3)(8,"section",4)(9,"h2")(10,"span",5),i(11,"campaign"),n(),i(12," EN COURS DE SERVICE "),n(),m(13,w,3,0,"div",6)(14,E,5,0),n(),a(15,"section",7)(16,"h2")(17,"span",5),i(18,"schedule"),n(),i(19," PROCHAINS APPELS "),n(),m(20,I,3,0,"div",8)(21,Q,2,0),n()(),a(22,"footer",9)(23,"p"),i(24,"Merci de patienter - Votre ticket sera appel\xE9 prochainement"),n()()()),o&2&&(s(5),l(S(6,3,c.currentTime,"HH:mm:ss")),s(8),p(13,!(c.queueStatus==null||c.queueStatus.nowServing==null)&&c.queueStatus.nowServing.length?13:14),s(7),p(20,!(c.queueStatus==null||c.queueStatus.nextInQueue==null)&&c.queueStatus.nextInQueue.length?20:21))},dependencies:[y,b],styles:[".queue-display-page[_ngcontent-%COMP%]{min-height:100vh;background:linear-gradient(135deg,#1a365d,#0d1b2a);color:#fff;display:flex;flex-direction:column}.display-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1.5rem 2rem;background:#0003}.display-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem}.time[_ngcontent-%COMP%]{font-size:2rem;font-family:monospace}.display-content[_ngcontent-%COMP%]{flex:1;display:grid;grid-template-columns:2fr 1fr;gap:2rem;padding:2rem}.now-serving[_ngcontent-%COMP%], .waiting-section[_ngcontent-%COMP%]{background:#ffffff0d;border-radius:16px;padding:2rem}h2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:1.5rem;font-size:1.5rem;text-transform:uppercase;letter-spacing:.05em}.serving-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1.5rem}.serving-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#38a169,#2f855a);padding:2rem;border-radius:16px;text-align:center;box-shadow:0 10px 30px #0000004d}.serving-card.pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s infinite}.ticket-number[_ngcontent-%COMP%]{font-size:4rem;font-weight:700;letter-spacing:.1em;text-shadow:2px 2px 4px rgba(0,0,0,.3)}.counter-info[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem;font-size:1.5rem;margin-top:1rem;opacity:.9}.waiting-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.waiting-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;background:#ffffff1a;padding:1rem 1.5rem;border-radius:8px}.position[_ngcontent-%COMP%]{width:36px;height:36px;background:#fff3;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:600}.ticket-num[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;letter-spacing:.05em}.no-tickets[_ngcontent-%COMP%], .no-waiting[_ngcontent-%COMP%]{text-align:center;opacity:.5;padding:3rem}.no-tickets[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:4rem}.display-footer[_ngcontent-%COMP%]{text-align:center;padding:1rem;background:#0003;opacity:.7}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1);box-shadow:0 10px 30px #0000004d}50%{transform:scale(1.02);box-shadow:0 15px 40px #38a16966}}@media (max-width: 768px){.display-content[_ngcontent-%COMP%]{grid-template-columns:1fr}.ticket-number[_ngcontent-%COMP%]{font-size:3rem}}"]})}}return t})();export{F as QueueDisplayComponent};
